import { npxImport } from "npx-import-light";
let SmeeClient;
export const createWebhookProxy = async (opts) => {
    try {
        SmeeClient ??= (await npxImport("smee-client@5.0.0", { onlyPackageRunner: true })).SmeeClient;
    }
    catch {
        opts.logger.warn("Run `npm install --save-dev smee-client` to proxy webhooks to localhost.");
        return undefined;
    }
    const smeeClient = new SmeeClient({
        logger: opts.logger,
        source: opts.url,
        target: `http://${opts.host}:${opts.port}${opts.path}`,
        fetch: opts.fetch,
    });
    return await smeeClient.start();
};
